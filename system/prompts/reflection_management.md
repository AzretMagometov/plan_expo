# Промпт для управления рефлексиями

## Задача
Генерация шаблонов рефлексий, анализ заполненных рефлексий и адаптация целей на основе обратной связи.

## Структура директории reflections/

```
reflections/
├── daily/
│   ├── 2024/
│   │   ├── 01/
│   │   │   ├── 2024-01-15.md
│   │   │   ├── 2024-01-16.md
│   │   │   └── ...
│   │   └── 02/
│   └── ...
├── weekly/
│   └── 2024/
│       ├── week_01_2024.md
│       ├── week_02_2024.md
│       └── ...
├── monthly/
│   └── 2024/
│       ├── 2024-01.md
│       ├── 2024-02.md
│       └── ...
├── quarterly/
│   └── 2024/
│       ├── Q1_2024.md
│       ├── Q2_2024.md
│       └── ...
└── yearly/
    └── 2024.md
```

## Шаблон ежедневной рефлексии

### Структура файла `reflections/daily/YYYY/MM/YYYY-MM-DD.md`:

```markdown
# Ежедневная рефлексия: [дата]

## Активные цели

[Список активных целей с кратким описанием]

---

## План на сегодня

### Операционные действия

#### Implementation Intentions:
- [ ] ЕСЛИ [триггер] → ТО [действие]
- [ ] ЕСЛИ [триггер] → ТО [действие]

#### Tiny Habits:
- [ ] После [якорь] → [действие]
- [ ] После [якорь] → [действие]

### Тактические задачи

[Список задач, связанных с Key Results или SMART-целями]

---

## Выполнение

### Что сделано

#### Операции:
- [ ] [действие] - [время выполнения] - [комментарий]
- [ ] [действие] - [время выполнения] - [комментарий]

#### Тактика:
- [ ] [задача] - [результат/прогресс]

### Доказательства идентичности

- [ ] [действие] = [доказательство]
- [ ] [действие] = [доказательство]

### Препятствия и решения

**Что помешало:**
- [препятствие 1] → [решение/адаптация]
- [препятствие 2] → [решение/адаптация]

**Что помогло:**
- [фактор успеха 1]
- [фактор успеха 2]

---

## Оценка дня

**Общая оценка:** [1-10]

**Выполнение операций:** [%]
**Выполнение тактики:** [%]

**Энергия:** [высокая | средняя | низкая]
**Мотивация:** [высокая | средняя | низкая]
**Фокус:** [высокий | средний | низкий]

---

## Инсайты и наблюдения

[Свободные заметки о дне, что узнал, что изменилось]

---

## План на завтра

[Ключевые действия на следующий день]

---

## Комментарии ИИ-системы

[Автоматически генерируется после анализа заполненной рефлексии]

### Анализ прогресса:
- [анализ выполнения операций]
- [анализ выполнения тактики]
- [анализ доказательств идентичности]

### Рекомендации:
- [рекомендация 1]
- [рекомендация 2]

### Адаптации:
- [если нужны изменения в целях или планах]
```

## Процесс работы с рефлексиями

### Шаг 1: Генерация шаблона

1. **Определи дату** для рефлексии
2. **Прочитай все активные цели** из `goals/`
3. **Извлеки из целей:**
   - Операционные действия (Implementation Intentions, Tiny Habits)
   - Тактические задачи на сегодня
   - Доказательства идентичности для отслеживания
4. **Создай файл** по пути `reflections/daily/YYYY/MM/YYYY-MM-DD.md`
5. **Заполни шаблон** данными из целей

### Шаг 2: Анализ заполненной рефлексии

После того, как пользователь заполнил рефлексию:

1. **Прочитай заполненную рефлексию**
2. **Проанализируй:**
   - Процент выполнения операций
   - Процент выполнения тактики
   - Количество доказательств идентичности
   - Препятствия и их решения
   - Энергия, мотивация, фокус
3. **Сравни с планом:**
   - Что выполнено, что нет
   - Почему не выполнено
   - Что можно улучшить
4. **Сгенерируй комментарии:**
   - Анализ прогресса
   - Рекомендации
   - Предложения по адаптации

### Шаг 3: Адаптация целей

Если анализ показывает необходимость изменений:

1. **Определи, что нужно изменить:**
   - Слишком сложные действия → упростить
   - Не работающие триггеры → изменить
   - Нереалистичные метрики → скорректировать
   - Новые препятствия → добавить If-Then планы
2. **Обнови файл цели** в `goals/`
3. **Добавь запись в историю изменений**
4. **Уведоми пользователя** о изменениях

## Шаблоны других типов рефлексий

### Еженедельная рефлексия

```markdown
# Еженедельная рефлексия: Неделя [номер], [год]

## Период: [дата начала] - [дата окончания]

## Статистика недели

**Выполнение операций:** [%] (дней подряд: [число])
**Выполнение тактики:** [%]
**Доказательств идентичности:** [число]

## Прогресс по целям

[Для каждой активной цели:]
- **Цель:** [название]
- **Прогресс:** [%]
- **Изменение за неделю:** [+/-%]
- **Ключевые достижения:**
  - [достижение 1]
  - [достижение 2]

## Что сработало

- [фактор успеха 1]
- [фактор успеха 2]

## Что нужно улучшить

- [проблема 1] → [решение]
- [проблема 2] → [решение]

## План на следующую неделю

[Ключевые цели и действия]
```

### Ежемесячная рефлексия

Аналогично еженедельной, но с фокусом на:
- Общий прогресс за месяц
- Тренды (улучшение/ухудшение)
- Крупные достижения
- Стратегические инсайты

### Квартальная рефлексия

Фокус на:
- Достижение тактических целей (OKR/SMART)
- Оценка прогресса к стратегической идентичности
- Крупные изменения и адаптации
- Планирование следующего квартала

### Годовая рефлексия

Фокус на:
- Достижение стратегических целей
- Изменения в идентичности
- Крупные трансформации
- Планирование на следующий год

## Процесс анализа рефлексии через ИИ

Когда пользователь сообщает, что рефлексия готова к анализу:

### Шаг 1: Чтение и парсинг рефлексии

1. **Прочитай файл рефлексии** из `reflections/daily/YYYY/MM/YYYY-MM-DD.md`
2. **Извлеки данные:**
   - Выполненные операции (Implementation Intentions, Tiny Habits)
   - Выполненные тактические задачи
   - Доказательства идентичности
   - Препятствия и решения
   - Оценки (общая, энергия, мотивация, фокус)
   - Инсайты и наблюдения
   - План на завтра

### Шаг 2: Анализ выполнения

#### Анализ операций:
- Подсчитай процент выполненных Implementation Intentions
- Подсчитай процент выполненных Tiny Habits
- Определи streak (дни подряд выполнения)
- Выяви паттерны (что выполняется стабильно, что нет)

#### Анализ тактики:
- Сравни выполненные задачи с планом
- Оцени прогресс по Key Results (если есть обновления метрик)
- Выяви отставания или опережения плана

#### Анализ идентичности:
- Подсчитай количество доказательств идентичности за день
- Оцени качество доказательств
- Проверь связь действий с стратегической идентичностью

### Шаг 3: Выявление критических событий

**Ищи признаки критических событий в:**
- Секции "Препятствия и решения"
- Секции "Инсайты и наблюдения"
- Секции "Что помешало"

**Ключевые слова для вынужденных изменений:**
- авария, потерял, уволили, болезнь, кризис
- не могу, невозможно, форс-мажор
- вынужден, пришлось, обстоятельства

**Ключевые слова для добровольных изменений:**
- решил изменить, переосмыслил, понял что
- новые приоритеты, больше не актуально
- хочу сфокусироваться

**Если найдено критическое событие:**
1. Подтверди с пользователем
2. Обнови файл цели с типом изменения (используй `prompts/goal_change_tracking.md`)
3. Добавь в секцию "КРИТИЧЕСКИЕ СОБЫТИЯ" если это FORCED_CHANGE

### Шаг 4: Генерация комментариев

Создай секцию "Комментарии ИИ-системы" в файле рефлексии:

```markdown
## Комментарии ИИ-системы

*[Автоматически сгенерировано после анализа]*

### Анализ прогресса:
- [анализ выполнения операций]
- [анализ выполнения тактики]
- [анализ доказательств идентичности]
- [общая оценка дня]

### Рекомендации:
- [рекомендация 1]
- [рекомендация 2]
- [рекомендация 3]

### Критические события:
- [если найдены критические события]

### Адаптации:
- [предложения по изменению целей или планов]
```

### Шаг 5: Обновление целей

Если анализ показал необходимость изменений:

1. **Открой файл цели** из `goals/`
2. **Обнови метрики:**
   - Текущие значения Key Results (если были обновления)
   - Процент прогресса
   - Доказательства идентичности
3. **Если есть критические события:**
   - Используй `prompts/goal_change_tracking.md`
   - Обнови статус и тип изменения
   - Добавь в "КРИТИЧЕСКИЕ СОБЫТИЯ"
4. **Добавь запись в "ИСТОРИЯ ИЗМЕНЕНИЙ"**
5. **Обнови "Последнее обновление"**

### Шаг 6: Предложение адаптаций

На основе анализа предложи:

- **Если низкое выполнение операций (<50%):**
  - Упростить действия
  - Изменить триггеры
  - Разбить на меньшие шаги

- **Если низкий прогресс по тактике:**
  - Скорректировать метрики
  - Разбить задачи на меньшие
  - Изменить дедлайны

- **Если найдены критические события:**
  - Адаптировать цель
  - Создать новую цель
  - Изменить статус

## Пример анализа

**Пользователь:** "Готово, проанализируй рефлексию за сегодня"

**ИИ:**
1. Читает `reflections/daily/2025/12/2025-12-21.md`
2. Анализирует выполнение:
   - Операции: 3/5 Tiny Habits выполнено (60%)
   - Тактика: 1/2 задачи выполнено (50%)
   - Доказательства идентичности: 2
3. Выявляет препятствие: "Не хватило времени на утренний кодинг"
4. Генерирует комментарии с анализом и рекомендациями
5. Обновляет файл рефлексии
6. При необходимости обновляет файл цели

## Автоматизация

**Генерация шаблонов:**
- Можно использовать Python скрипт `scripts/generate_reflection.py` для генерации шаблонов
- Или создать шаблон вручную по структуре выше

**Анализ:**
- **ВСЕГДА через ИИ** - не используй Python скрипты для анализа
- ИИ читает рефлексию, анализирует, генерирует комментарии и обновляет цели

